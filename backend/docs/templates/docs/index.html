{% extends "layouts/layout.html" %}

{% block heading %}
Secure Documents
{% endblock %}

{% block body %}

{% if request.user.is_authenticated %}
<p>Welcome, {{ request.user.username }}</p>
{% endif %}

{% if docs|length or q %}
<form method="GET" action="{% url 'docs' %}" class="mt-4">
  {{ search_form.as_p }}
</form>
{% endif %}

{% if docs|length %}
<ul class="entries my-5">
  {% for doc in docs %}
  <li class="entry">
    <p>{{ doc.id }}</p>
    <p>{{ doc.title }}</p>
    <p>{{ doc.content }}</p>
    <p>{{ doc.owner.username }}</p>
    <p><a href="{{ doc.file.url }}">{{ doc.file.name }}</a> ({{ doc.file.size|filesizeformat }})</p>
    <span>{{ doc.created_at }}</span>
    {% if perms.docs.delete_doc %}
    <form method="POST" action="/{{ doc.id }}/delete">
      {% csrf_token %}
      <button type="submit" class="mt-2 w-32 !bg-pink-400 !border-pink-500">Delete</button>
    </form>
    {% endif %}
  </li>
  {% endfor %}
</ul>
{% endif %}

{% if request.user.is_authenticated %}
<ul>
  <li>
    <a href="{% url 'upload_doc' %}">Upload Document</a>
  </li>
</ul>
{% endif %}
{% endblock %}
